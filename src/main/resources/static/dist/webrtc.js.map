{
  "version": 3,
  "sources": ["../js/util/webrtc/webrtcUtil.js", "../js/business/webrtc.js"],
  "sourcesContent": ["'use strict';\r\n\r\nclass RtcInterface {\r\n\t#constraints = {\r\n\t\tcam: {\r\n\t\t\tvideo: {\r\n\t\t\t\twidth: {\r\n\t\t\t\t\tmax: 640,\r\n\t\t\t\t},\r\n\t\t\t\theight: {\r\n\t\t\t\t\tmax: 480,\r\n\t\t\t\t},\r\n\t\t\t\tframeRate: {\r\n\t\t\t\t\tmax: 10,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taudio: false,\r\n\t\t},\r\n\t\tdisplay: {\r\n\t\t\tvideo: {\r\n\t\t\t\taspectRatio: 1.3296398891966759, //4:3\r\n\t\t\t\tdisplaySurface: 'monitor',\r\n\t\t\t\tframeRate: 30,\r\n\t\t\t\tcursor: 'never',\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n\t#mediaStream = new Map();\r\n\tconstructor() {}\r\n\r\n\tget constraints() {\r\n\t\treturn this.#constraints;\r\n\t}\r\n\r\n\tset constraints(constrains) {\r\n\t\tthis.#constraints = constrains;\r\n\t}\r\n\r\n\tget mediaStream() {\r\n\t\treturn this.#mediaStream;\r\n\t}\r\n\r\n\tset mediaStream(mediaStream) {\r\n\t\tconst { type, stream } = mediaStream;\r\n\t\tthis.#mediaStream.set(type, stream);\r\n\t}\r\n}\r\n\r\nclass WebRtcUtil extends RtcInterface {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tasync CamInit() {\r\n\t\tconst { getUserMedia } = navigator.mediaDevices;\r\n\t\tif (getUserMedia) {\r\n\t\t\tthis.mediaStream = {\r\n\t\t\t\ttype: 'cam',\r\n\t\t\t\tstream: await navigator.mediaDevices.getUserMedia(this.constraints['cam']),\r\n\t\t\t};\r\n\t\t\tdocument.getElementById('userCam').srcObject = this.mediaStream.get('cam');\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\tasync DisplayInit() {\r\n\t\tconst { getDisplayMedia } = navigator.mediaDevices;\r\n\t\tif (!getDisplayMedia) return;\r\n\r\n\t\tconst setform = {\r\n\t\t\ttype: 'display',\r\n\t\t\tstream: null,\r\n\t\t};\r\n\t\tconst stream = await navigator.mediaDevices.getDisplayMedia(this.constraints['display']).catch(e => {\r\n\t\t\treturn e.message;\r\n\t\t});\r\n\t\t//\uC0AC\uC6A9\uC790 Display(\uBAA8\uB2C8\uD130) \uD654\uBA74\uC744 \uAC00\uC838\uC624\uC9C0 \uBABB\uD588\uB2E4\uBA74 return;\r\n\t\tif (!(stream instanceof MediaStream)) {\r\n\t\t\talert(stream);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//\uC0AC\uC6A9\uC790 Display\uB97C \uAC00\uC838\uC628 \uD0C0\uC785\r\n\t\tconst displaySurface = stream.getVideoTracks()[0].getSettings().displaySurface;\r\n\t\tif (displaySurface !== 'monitor') {\r\n\t\t\talert('\uC0AC\uC6A9\uC790\uC758 \uBAA8\uB2C8\uD130\uB97C \uC120\uD0DD\uD574\uC57C\uD569\uB2C8\uB2E4.');\r\n\t\t\twindow.location.reload();\r\n\t\t}\r\n\t\tsetform['stream'] = stream;\r\n\t\tthis.mediaStream = setform;\r\n\t\tdocument.getElementById('pcDisplay').srcObject = this.mediaStream.get('display');\r\n\t}\r\n}\r\n\r\nclass ScreenShot {\r\n\tstatic async Action(stream) {\r\n\t\tconst streamTrack = stream.getTracks();\r\n\t\tif (!streamTrack.length) return;\r\n\t\tconst reader = new FileReader();\r\n\t\tconst imgBlob = await new ImageCapture(streamTrack[0]).takePhoto();\r\n\t\tconst image = new Image();\r\n\t\treader.readAsDataURL(imgBlob);\r\n\t\treader.onloadend = evt => {\r\n\t\t\tconst { result } = evt.currentTarget;\r\n\t\t\timage.src = result;\r\n\t\t\tdocument.getElementById('userSnapShot').src = result;\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport { WebRtcUtil, ScreenShot };\r\n", "'use strict';\r\n\r\nimport { WebRtcUtil as Wr, ScreenShot } from '../util/webrtc/webrtcUtil.js';\r\nconst myModalEl = document.getElementById('exampleModal');\r\nconst modal = new mdb.Modal(myModalEl);\r\nconst wr = new Wr();\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n\tawait wr.CamInit().then(res => res.DisplayInit());\r\n\r\n\tdocument.getElementById('actScreen').onclick = () => {\r\n\t\tmodal.show();\r\n\t\tconst camStream = wr.mediaStream.get('cam');\r\n\t\tScreenShot.Action(camStream);\r\n\t};\r\n\r\n\tdocument.getElementById('camFrameRange').onchange = ChangeStreamConstraint;\r\n\tdocument.getElementById('diplayFrameRange').onchange = ChangeStreamConstraint;\r\n\r\n\tfunction ChangeStreamConstraint(evt) {\r\n\t\tconst { id, value } = evt.target;\r\n\t\tconst [camStream, displayStream] = [wr.mediaStream.get('cam'), wr.mediaStream.get('display')];\r\n\t\tif (id === 'camFrameRange') {\r\n\t\t\twr.constraints['cam'] = {\r\n\t\t\t\tframeRate: {\r\n\t\t\t\t\tmax: parseInt(value),\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\tcamStream.getTracks()[0].applyConstraints(wr.constraints['cam']);\r\n\t\t} else {\r\n\t\t\twr.constraints['display'] = {\r\n\t\t\t\tframeRate: parseInt(value),\r\n\t\t\t};\r\n\t\t\tconsole.log(displayStream.getTracks());\r\n\t\t\tdisplayStream.getTracks()[0].applyConstraints(wr.constraints['display']);\r\n\t\t}\r\n\t}\r\n});\r\n"],
  "mappings": "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",
  "names": []
}
